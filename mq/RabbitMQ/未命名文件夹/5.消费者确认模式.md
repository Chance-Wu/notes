>消费者应用——用来接受和处理消息的应用，在处理消息的时候偶尔会失败或者有时会直接崩溃掉。而且网络原因也可能引起各种问题。AMQP代理在什么时候删除消息才是正确的呢？
>
>`AMQP 0-9-1规范`给出两种建议：
>
>- ==自动确认==：当消息代理（broker）将消息发送给应用后立即删除。（basic.deliver或者basic.getok）
>- ==手动确认==：待应用发送一个确认回执后再删除消息。（basic.ack）
>
>==在手动确认模式下，由消费者应用来选择什么时候发送确认回执==（应用可以在收到消息后立即发送，或将未处理的消息存储后发送，或等到消息被处理完毕后再确认回执）。如果一个消费者在尚未确认回执的情况下挂掉了，那么AMQP代理会将消息重新投递给另一个消费者。如果当时没有可用的消费者了，消息代理会死等下一个注册到此队列的消费者，然后再次尝试投递。



#### 1. 手动确认

---

| 方法                                                         | 描述                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| ==basicAck(long deliveryTag, boolean multiple)==             | 用于肯定确认，multiple参数用于多个消息确认                   |
| basicRecover(boolean requeue)                                | 是路由不成功的消息可以使用recovery重新发送到队列中           |
| basicReject(long deliveryTag, boolean requeue)               | 接收端告诉服务器这个消息拒绝接受，不处理，<br />可以设置是否放回到队列中还是丢掉，<br />而且只能一次拒绝一个消息 |
| ==basicNack(long deliveryTag, boolean multiple, boolean requeue)== | 一次拒绝N条消息，客户端可以设置multiple参数为true            |

