### 一、操作系统做了什么

---

通过一个例子进行说明：给出一个c程序helloworld

```c
#include<stdio.h>
int main(int argc, char *argv[]){
  puts(“hello world”);
  return 0;
}
```

**说明：**其功能就是在标准的显示器上显示一个字符串。下面看此程序的执行过程。

- 首先用户要告诉操作系统执行此程序：

  如何告知？比如我们可以在命令行输入相应的命令或者双击此程序的图标。

- 操作系统接到用户的请求之后就会到磁盘上找到此程序的相关信息，检查其类型是否是可执行文件；并通过程序首部信息，确定代码和数据在可执行文件中的位置并计算出对应的磁盘块地址。

- 为了要执行此程序，操作系统首先要创建一个新的进程，并**将此程序的可执行文件映射到该进程结构**，表示由该进行执行此程序。之后操作系统为此程序设置CPU上下文环境，并跳到程序开始处（假设调度程序选中了此程序）。

- 当在执行程序的第一条指令的时候会发生缺页异常：因为程序在执行的时候，先要将程序的代码和数据装入内存，CPU才能够去执行。但是此时还没有读入内存，于是硬件机制就会捕获此异常，并且把控制权交给操作系统。

- 操作系统管理了系统中的内存，当然内存有很多中，比如这里我们拿页式管理方案的话，内存就会有很多的物理页面，操作系统的内存管理模块就会分配一页空闲物理内存，并且根据前面计算出的磁盘块地址把程序代码读到内存中，然后继续执行程序。有时候程序可能很大，所以一次分配可能不够，于是在执行过程中可能产生多次缺页异常。

- 然后程序执行`puts`函数（系统调用）。而puts函数是一个系统调用，于是控制权又交给了操作系统。

- 操作系统找到要将字符串送往的显示设备，通常设备是由一个进程控制的，所以，操作系统将要写的字符串送给该进程。

- 控制设备的进程告诉设备的窗口系统它要显示的字符串，窗口系统确定这是一个合法的操作，然后将字符串转换成像素，将像素写入设备的存储映像区。

- 然后视频硬件将像素转换成显示器可以接收的一组控制/数据信号。显示器然后解释此信号，激发液晶屏。

**总结**：

- 从用户的角度看上述执行过程

  ![](img/1925650-2c39278a4954f03b.png)

- 从操作系统的角度来看就是，如果操作系统选中了一个程序，那么就去调度此程序执行，程序执行过程中会不断的陷入操作系统，由操作系统去提供一些服务，当服务完成之后操作系统又会去调用程序去执行。

  ![](img/1925650-cc834536f9af8cd6.png)



### 二、操作系统的定义和作用

---

#### 2.1 定义

操作系统是计算机系统中的一个系统软件，是一些程序模块的集合：

- 它们能以尽量有效、合理的方式组织和管理计算机的软硬件资源
- 合理地组织计算机的工作流程，控制程序的执行并向用户提供各种服务功能
- 使得用户能够灵活、方便地使用计算机，使整个计算机系统高效运行。

#### 2.2 操作系统管的作用

>**资源的管理者：有效**
>
>这是从自底向上看的，即从操作系统内部来看。
>
>- 硬件资源：CPU、内存、设备等
>- 软件资源：磁盘上的文件、各类管理信息等。
>
>**1、怎样管理资源？**
>
>- 跟踪记录资源的使用状况：这是使用各类数据结构来跟踪的，跟踪的信息有如哪些资源空闲，分配给谁使用，允许使用多长时间等。
>- 确定资源分配侧露：即需要相关的算法。如静态分配策略（进程需要的资源一开始就分配好，会导致浪费），动态分配策略（在一个进程的执行过程中什么时候需要什么时候分配）
>- 实施资源的分配和回收
>- 提供资源利用率
>- 保护资源的使用
>- 协调多个进程对资源请求的冲突
>
>**2、从资源管理的角度：五大基本功能**(重点)
>
>- **进程/线程管理（`CPU`管理）**：进程线程状态、控制、同步互斥、通信、调度、…
>- **存储管理**：分配/回收、地址转换、存储保护、内存扩充、…
>- **文件管理**：文件目录、文件操作、磁盘空间、文件存取控制、…
>- **设备管理**：设备驱动、分配回收、缓冲技术、…
>- **用户接口**：命令接口,程序接口,图形接口

>**向用户提供各种服务：方便使用**
>
>操作系统是各种系统服务的提供者
>
>- 在操作系统之上，从用户角度来看：操作系统为用户提供了一组功能强大。方便易用的命令或系统调用
>
> - 典型服务： 进程的创建、执行；文件和目录操作；IO设备的使用；各类统计信息；…
>

>**对硬件机器的扩展：扩展能力**
>
>操作系统是硬件之上的第一层软件，我们使用操作系统将硬件屏蔽，而让操作系统给我们提供操作各类硬件的接口。因为与硬件相关的工作是很复杂和繁琐的。于是操作系统就是对硬件机器的扩展：
>
>- 操作系统在应用程序与硬件之间建立了一个等价的扩展机器（虚拟机器）
>- 对硬件抽象，提高可移植性；比底层硬件更容易编程



### 三、操作系统的主要特征（重点）

---

#### 3.1 并发

指处理多个同时性活动的能力。

- 由于并发将可能引起很多问题：活动切换、保护、相互依赖的活动间的同步
- 在计算机系统中同时存在多个程序运行，但cpu上：
  - 宏观上：这些程序同时在执行
  - 微观上：任何时刻只有一个程序真正在执行，即这些程序在cpu上是轮流执行的
- 并行：与并发类似，但多指不同程序同时在多个硬件部件上执行，比如多cpu系统。

#### 3.2 共享

操作系统与多个用户的程序共同使用计算机系统中的资源。

操作系统要对系统资源进行合理的分配和使用，资源在一个时间段内交替被多个进程使用。

- 互斥共享（如打印机）
- 同时共享（如可重入代码、磁盘文件）
- 问题：资源分配难以达到最优化，如何保护资源？

#### 3.3 虚拟

- 一个物理实体（如cpu）映射为若干个对应的逻辑实体：分时或分空间；
- 虚拟是操作系统管理系统资源的重要手段，可提高资源利用率。

#### 3.4 随机

操作系统必须随时对以不可预测的次序发生的事件进行响应并处理：

- 进程的运行速度不可预知；
- 难以重现系统在某个时刻的状态（包括运行中的错误）。



### 四、典型的操作系统架构

---

- Windows架构
- Unix架构
- Linux架构
- Android架构



### 五、操作系统分类

---

#### 5.1 传统分类

操作系统发展进程：大型机——>个人计算机——>网络——>移动计算机——>

















































