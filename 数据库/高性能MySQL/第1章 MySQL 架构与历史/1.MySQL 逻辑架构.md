>MySQL服务器逻辑架构图
>
><img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gnry5700r3j307p07ddfx.jpg" style="zoom:100%">
>
>1. **客户端层**
>
>   负责连接处理、授权认证、安全服务等功能的处理。
>
>2. **核心服务层**
>
>   ==查询解析==、==分析==、==优化==、==缓存==以及所有的==内置函数==（如日期、时间、数学和加密函数）。所有跨存储引擎的功能都在这一层实现：存储过程、触发器、视图等。
>
>3. **存储引擎**
>
>   负责MySQL中的数据存储和提取。中间的==服务层通过API与存储引擎进行通信==。这些接口屏蔽了不同存储引擎之间的差异，使得这些差异对上层的查询过程透明。

#### 1. 连接管理与安全性

>==每个客户端连接都会在服务器进程中拥有一个线程==，这个连接的查询只会在这个单独的线程中执行，该线程只能轮流在某个CPU核心或者CPU中运行。==服务器会负责缓存线程，因此不需要为每一个新建的连接创建或者销毁线程==。
>
>当客户端(应用)连接到MySQL服务器时，服务器需要对其进行==认证==。认证基于用户名、原始主机信息和密码。如果使用了安全套接字(SSL)的方式连接，还可以使用X.509证书认证。一旦客户端连接成功，服务器会继续==验证该客户端是否具有执行某个特定查询的权限==。

#### 2. 优化与执行

>MySQL会解析查询，并创建内部数据结构（解析树），然后对其进行各种优化，包括==重写查询==、==决定表的读取顺序==，以及==选择合适的索引==等。
>
>- 用户可以通过特殊的关键字提示（`hint`）优化器，影响它的决策过程。
>- 也可以请求优化器解释（`explain`）优化过程的各个因素，使用户知道服务器是如何进行优化决策的，并提供了一个参考基准，便于用户重构查询和schema、修改相关配置，使应用尽可能高效运行。

>优化器并不关心表使用的什么存储引擎，但存储引擎对于优化查询是有影响的。优化器会请求存储引擎提供容量或某个具体操作的开销信息，以及表数据的统计信息等。例如，某些存储引擎的某种索引，可能对一些特定的查询有优化。

><u>对于SELECT语句，在解析查询之前，服务器会先检查查询缓存（Query Cache），如果能够在其中找到对应的查询，服务器就不必再执行查询解析、优化和执行的整个过程，而是直接返回查询缓存中的结果集。</u>