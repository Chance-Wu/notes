>设计和执行基准测试时的常见错误：
>
>- 使用真实数据的子集而不是全集
>- 使用错误的数据分布
>- 在多用户场景中只做单用户测试
>- 在单服务器上测试分布式应用
>- 与真实用户行为不匹配
>- 反复执行同一个查询。这会跟真实情况下缓存命中率有较大差异。
>- 没有检查错误。MySQL 检测到语法错误后会停止查询，需要定期查看错误日志。
>- 忽略了系统预热。重启后缓存为空，查询较慢。
>- 使用了默认的服务器配置
>- 测试时间太短

#### 1. 设计和规划基准测试

>- 第一步，提出问题并明确目标。再决定采用标准的基准测试还是设计专用测试。
>- 然后，针对数据运行查询。可以建立单元测试集，但最好在一个典型时间段内（一整天或高峰时的一小时）记录生产系统上的所有查询。
>- 可以在不同级别记录查询。对于集成式（full-stack）基准测试，可以记录 Web 服务器上的 HTTP 请求，也可以打开 MySQL 的查询日志。
>- 写详细的测试规划。测试规划应该记录测试数据、系统配置的步骤、如何测量和分析结果、预热方案等。
>- 建立将参数和结果文档化的规范。每一轮测试都详细记录。

#### 2. 获取系统性能和状态

>执行基准测试时，需要尽可能的收集被测系统的信息，包括系统状态和性能指标，例如 <u>CPU 使用率</u>、<u>磁盘 I/O</u>、<u>网络流量统计</u>、<u>SHOW GLOBAL STATUS 计数器</u>等。可以==使用 shell 脚本收集这些数据==。

#### 3. 运行基准测试并收集结果

>自动化测试可以获得更精确的结果，避免测试人员误操作或出现失误。可以用 shell、PHP 等脚本语言实现自动化测试的所有过程，包括装载数据、系统预热、执行测试、记录结果等。