### 一、死锁

---

进程管理是操作系统的核心，但如果设计不当，就会出现死锁问题，如果一个进程在等待一件不可能发生的事，则进程就死锁了，此时该进程将一直占用部分系统资源，而如果多个进程产生死锁，就会造成系统资源被占用完毕，进而造成系统死锁。

解决方案：提高系统资源容量。

> 常见习题：计算机系统至少需要多少资源将不可能发生死锁问题。
>
> 例：系统有3个进程：A，B，C。这3个进程需要5个系统资源。如果系统至少有多少个资源，则不可能发生死锁。
>
> 一个进程在得到所有所需资源之后将释放自身占用的资源，因此该例至少需要13个资源则不可能发生死锁。计算方法，==将每个进程所需资源减去一然后把他们相加，总数再加一，即为避免死锁所需的最小资源==。



### 二、发生死锁的四大必要条件

---

1. **进程互斥**

2. **保持和等待**：

   在资源总量并未满足完成进程所需资源的总量前提下，每个进程都保持自身占用的资源不变并且一直等待其他进程完成以获取其释放的系统资源。

3. **不剥夺**：

   系统不会把已分配给一个进程的资源剥夺掉分配给其他进程。

4. **环路等待**：

   如总共有三个进程，A等待B，B等待C，C等待A；诸如此类的，等待的进程形成一个闭合环状。

> 注：死锁的预防就是通过打破四大条件来进行。



### 三、死锁的避免

---

1. **有序资源分配法**：将系统资源按照顺序分配给进程，一个进制完成后才将资源分配给下一个进程。
2. **银行家算法**（分配资源的原则）
   1. 当一个进程对资源的最大需求量不超过系统中的资源数时可以接纳该进程。
   2. 进程可以分期请求资源，但请求的总数不能超过最大需求量。
   3. 当系统现有的资源不能满足进程尚需资源数时，对进程的请求可以推迟分配，但总能使该进程在有限的时间里得到资源。

### 四、银行家算法

---

![img](6.%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86-%E6%AD%BB%E9%94%81%E9%97%AE%E9%A2%98.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ltcmVhbF8=,size_16,color_FFFFFF,t_70.jpeg)

解决该类问题，首先将系统所剩余资源数计算出来，然后将每个进程还差的资源数计算出来，进行比较之后，将系统资源分配给差的最少的进程，进而让其释放资源，然后进行下一个所需资源较少的进程的分配，由此将进程执行的顺序计算出来。

| 进程 | 每个进程还差的资源数              |
| ---- | --------------------------------- |
| P1   | [6，5，2] - [1，2，1] =[5，3，1]  |
| P2   | [2，2，1] - [2，1，1] = [0，1，0] |
| P3   | [8，1，1] - [2，1，0] = [6，0，1] |
| P4   | [1，2，1] - [1，2，0] = [0，0，1] |
| P5   | [3，4，4] - [1，1，3] = [2，3，1] |

可用资源 = [9，8，5] - [1+2+2+1+1，2+1+1+2+1，1+1+3] = [2，1，0]

答案：B