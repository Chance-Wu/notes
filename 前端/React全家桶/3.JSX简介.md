### 1. JSX简介

---

>考虑如下变量声明：`const element = <h1>Hello, world!<h1>`
>
>这个标签语法被称为JSX，是一个JavaScript的语法扩展。JSX可以很好地描述UI应该呈现出它应有交互的本质形式。JSX具有JavaScript的全部功能。



#### 1.1 为什么使用JSX

---

>React认为渲染逻辑本质上与其他UI逻辑内在耦合，比如，在UI中需要绑定处理事件、在某些时刻状态发生变化时需要通知到UI，以及需要在UI中展示准备好的数据。
>
>React并没有采用将<u>标记</u>与<u>逻辑</u>进行分离到不同文件这种人为地分离方式，而是通过将二者共同存放在称之为“组件”的松耦合单元之中，来实现==关注点分离==。



#### 1.2 JSX中嵌入表达式

---

>```jsx
>const name = 'Josh Perez';
>const element = <h1>Hello, {name}</h1>;
>
>ReactDOM.render(
>  element,
>  document.getElementById('root')
>);
>```
>
>在JSX语法中，可以在==大括号内放置任何有效的JavaScript表达式==。例如，2+2，user.firstName或formatName(user)都是有效的表达式。
>
>如下，调用JavaScript函数`formatName(user)`的结果，并将结果嵌入到`<h1>`元素中。
>
>```jsx
>function formatName(user) {
>  return user.firstName + ' ' + user.lastName;
>}
>
>const user = {
>  firstName: 'Harper',
>  lastName: 'Perez'
>};
>
>const element = {
>  <h1>
>    Hello, {formatName{user}}!
>  </h1>
>};
>
>ReacDOM.render(
>  element,
>  document.getElementById('root')
>);
>```
>
>为了便于阅读，我们会将 JSX 拆分为多行。同时，我们建议将内容包裹在括号中，这可以避免遇到[自动插入分号](http://stackoverflow.com/q/2846283)陷阱。



#### 1.3 JSX也是一个表达式

---

> 在编译之后，JSX表达式会被转为普通JavaScript函数调用，并且对其取值后得到JavaScript对象。可以在 `if` 语句和 `for` 循环的代码块中使用 JSX，将 JSX 赋值给变量，把 JSX 当作参数传入，以及从函数中返回 JSX：
>
> ```jsx
> function getGreeting(user) {
>   if (user) {
>     return <h1>Hello, {formatName(user)}!</h1>;
>   }
>   return <h1>Hello, Stranger.</h1>;
> }
> ```



#### 1.4 JSX特定属性

---

>通过使用引号，来将属性值指定为字符串字面量：
>
>```jsx
>const element = <div tabIndex="0"></div>
>```
>
>也可以使用大括号，来在属性值中插入一个JavaScript表达式：
>
>```jsx
>const element = <img src={user.avatarUrl}></img>;
>```
>
>在属性中嵌入JavaScript表达式时，不要在大括号外面加上引号。应该仅使用==引号（对于字符串）==或==大括号（对于表达式）==中的一个，对于同一属性不能同时使用这两种符号。

>⚠️
>
>因为 JSX 语法上更接近 JavaScript 而不是 HTML，所以 React DOM 使用 `camelCase`（小驼峰命名）来定义属性的名称，而不使用 HTML 属性名称的命名约定。
>
>例如，JSX 里的 `class` 变成了 [`className`](https://developer.mozilla.org/en-US/docs/Web/API/Element/className)，而 `tabindex` 则变为 [`tabIndex`](https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/tabIndex)。



#### 1.5 使用JSX指定子元素

---

>JSX标签里能够包含很多子元素：
>
>```jsx
>const element = (
>  <div>
>    <h1>Hello!</h1>
>    <h2>Good to see you here.</h2>
>  </div>
>);
>```



#### 1.6 JSX防止注入攻击

---

>```jsx
>const title = response.potentiallyMaliciousInput;
>// 直接使用是安全的：
>const element = <h1>{title}</h1>;
>```
>
>React DOM在渲染所有输入内容之前，默认会进行==转义==。它可以确保在你的应用中，永远不会注入那些并非自己明确编写的内容。==所有的内容在渲染之前都被转换成了字符串==。可以有效防止XSS（跨站脚本）攻击。



#### 1.7 JSX表示对象

---

> Babel会把JSX转译成一个名为`React.createElement()`函数调用。
>
> ```jsx
> const element = (
>   <h1 className="greeting">
>     Hello, world!
>   </h1>
> );
> ```
>
> 转译为：
>
> ```js
> const element = React.createElement(
>   'h1',
>   {className: 'greeting'},
>   'Hello, world!'
> );
> ```
>
> `React.createElement()` 会预先执行一些检查，以帮助编写无错代码，但实际上它创建了一个这样的对象：
>
> ```js
> // 以下为简化过的结构
> const element = {
>   type: 'h1',
>   props: {
>     className: 'greeting',
>     children: 'Hello, world!'
>   }
> };
> ```
>
> 这些对象被称为“React元素”。React读取这些对象来构建DOM以及保持随时更新。



### 2. 虚拟DOM的两种创建方式

---

#### 2.1 使用jsx创建虚拟DOM

---

> JavaScript XML：react定义的一种类似于XML的JS扩展语法，本质是`React.createElement(component,props,...children)`方法的语法糖。
>
> 用来简化创建虚拟DOM，写法：`var ele = <h1>Hello JSX!</h1>`。它不是字符串，也不是HTML/XML标签。最终产生的就是一个JS对象。
>
> 基本语法规则：
>
> 1. 定义虚拟DOM时，不要写引号。
> 2. 标签中混入JS表达式时要用`{}`。
> 3. 样式的类名指定不要用class，要用`className`。
> 4. 内联样式，要用style={{key:value}}的形式去写。
> 5. 只有一个根标签
> 6. 标签必须闭合
> 7. 标签首字母
>    - 若==小写字母开头==，则将该标签转为html中同名元素，若html中无该标签对应的同名元素，则报错。
>    - 若==大写字母开头==，react就去渲染对应的组件，若组件没有定义，则报错。
>
> ==babels.js的作用==：
>
> 1. 浏览器不能直接解析JSX代码，需要babel转义为纯JS的代码才能运行；
> 2. 只要用了JSX，都要加上type="text/babel"，声明需要babel来处理。

```jsx
<script type="text/babel" >
  const myId = 'aTgUiGu'
  const myData = 'HeLlo,rEaCt'

  //1.创建虚拟DOM
  const VDOM = (
  <div>
    <h2 className="title" id={myId.toLowerCase()}>
      <span style={{color:'white',fontSize:'29px'}}>{myData.toLowerCase()}</span>
    </h2>
    <h2 className="title" id={myId.toUpperCase()}>
      <span style={{color:'white',fontSize:'29px'}}>{myData.toLowerCase()}</span>
    </h2>
    <input type="text"/>
  </div>
  )
  //2.渲染虚拟DOM到页面
  ReactDOM.render(VDOM,document.getElementById('test'))

</script>
```



#### 2.2 使用js创建虚拟DOM（一般不用）

---

```jsx
<body>
  <!-- 准备好一个容器 -->
  <div id="test"></div>

  <!-- 引入react核心库 -->
  <script type="text/javascript" src="../js/react.development.js"></script>
  <!-- 引入react-dom，用于支持react操作dom -->
  <script
    type="text/javascript"
    src="../js/react-dom.development.js"
    ></script>

  <script type="text/javascript">
    const VDOM = React.createElement('h1',{id:'title'},'Hello,React')
    ReactDOM.render(VDOM,document.getElementById('test'))
  </script>
</body>
```



#### 2.3 虚拟DOM与真实DOM

---

>React提供了一些API来创建一种特别的js对象。
>
>```js
>const VDOM = React.createElement('xx',{id:'xx'},'xx');
>```
>
>关于虚拟DOM：
>
>1. 本质是==Object类型的对象==（一般对象）
>
>2. ==虚拟DOM比较“轻”==，真实DOM比较“重”，因为虚拟DOM是React内部在用，无需真实DOM上那么多的属性。
>
>3. 虚拟DOM最终会被React转化为真实DOM，呈现在页面上。



#### 2.4 渲染虚拟DOM元素

---

>语法：`ReactDOM.render(virtualDOM,containerDOM)`
>
>参数：纯js或jsx创建的虚拟DOM对象、用来包含DOM元素的真实dom元素对象（一般是一个div）
>
>将虚拟DOM元素渲染到页面中的真实容器DOM中显示。