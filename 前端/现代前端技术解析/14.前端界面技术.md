### 一、CSS 样式统一化

---

CSS样式统一化时确保项目视觉一致性、提升可维护性、减少样式冲突的关键环节。尤其是在团队协作或多页面应用中，统一的样式规范能显著提高开发效率和用户体验。

#### 1.1 为什么需要样式统一化

- **避免样式混乱**：不同开发者写出的 CSS 风格不一，导致页面风格割裂。
- **提升复用性**：统一按钮、输入框等组件样式，避免重复代码。
- **便于维护**：修改一次，全局生效。
- **增强可访问性与响应式一致性**：统一字体、间距、颜色对比度等。

#### 1.2 重置或标准还默认样式

浏览器对 HTML 元素有默认样式（如 `<h1>` 的 margin、`<ul>`的 padding），需先统一。

| 方案              | 说明                                                         |
| ----------------- | ------------------------------------------------------------ |
| **CSS Reset**     | 清除所有默认样式（如 `margin: 0; padding: 0;`）              |
| **Normalize.css** | 保留有用默认样式，修复浏览器差异（推荐）                     |
| **现代替代**      | 使用 `* { margin: 0; padding: 0; box-sizing: border-box; }` 简单重置 |

```css
*, *::before, *::after {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}
```

>✅ 推荐：结合 `Normalize.css` + 自定义基础重置。

#### 1.3 建立设计系统

定义一套设计语言，作为样式统一的“源头”。

1. 颜色系统

   ```css
   :root {
     --color-primary: #1890ff;
     --color-success: #52c41a;
     --color-warning: #faad14;
     --color-error: #f5222d;
     --color-text: #333;
     --color-bg: #f9f9f9;
   }
   ```

   使用方式：

   ```css
   .btn-primary {
     background-color: var(--color-primary);
     color: white;
   }
   ```

2. 字体系统

   ```css
   :root {
     --font-size-small: 12px;
     --font-size-normal: 14px;
     --font-size-large: 16px;
     --font-family-base: 'Helvetica Neue', Arial, sans-serif;
   }
   body {
     font: var(--font-size-normal) / 1.5 var(--font-family-base);
   }
   ```

3. 间距系统（使用统一的间距单位（如 4px 基数））

   ```css
   :root {
     --space-1: 4px;
     --space-2: 8px;
     --space-3: 12px;
     --space-4: 16px;
     --space-6: 24px;
     --space-8: 32px;
   }
   ```

   使用：

   ```css
   .card {
     padding: var(--space-4);
     margin-bottom: var(--space-6);
   }
   ```

#### 1.4 使用 CSS 自定义属性

将可变值提取为变量，便于主题切换和统一管理。

```css
:root {
  --border-radius: 4px;
  --box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  --transition: all 0.3s ease;
}

.button {
  border-radius: var(--border-radius);
  box-shadow: var(--box-shadow);
  transition: var(--transition);
}
```

支持动态切换主题（如暗黑模式）：

```js
document.documentElement.setAttribute('data-theme', 'dark');
```

```css
[data-theme="dark"] {
  --color-bg: #1a1a1a;
  --color-text: #eee;
}
```

#### 1.5 统一组件样式

将常用 UI 元素封装为可复用的样式类。

示例：统一按钮样式

```css
.btn {
  display: inline-block;
  padding: 8px 16px;
  font-size: var(--font-size-normal);
  border: 1px solid transparent;
  border-radius: var(--border-radius);
  cursor: pointer;
  text-align: center;
  transition: background 0.3s;
}

.btn-primary {
  background: var(--color-primary);
  color: white;
  border-color: var(--color-primary);
}

.btn-primary:hover {
  background: #106eb0;
}

.btn-outlined {
  background: transparent;
  color: var(--color-primary);
  border-color: var(--color-primary);
}
```

使用：

```html
<button class="btn btn-primary">确定</button>
<button class="btn btn-outlined">取消</button>
```

#### 1.6 采用CSS方法论或架构

1. BEM（Block__Element--Modifier）命名规范

   ```css
   /* 块（Block） */
   .card {
     border: 1px solid #ddd;
     border-radius: 8px;
   }
   
   /* 元素（Element） */
   .card__title {
     font-size: 18px;
     padding: 16px;
   }
   
   /* 修饰符（Modifier） */
   .card__title--highlight {
     color: var(--color-primary);
   }
   ```

2. Utility-First（如 Tailwind CSS）

   通过原子类组合实现统一：

   ```css
   <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
     提交
   </button>
   ```

   优点：样式高度复用，无需写额外CSS。

#### 1.7 使用预处理器或PostCSS提升可维护性

1. Sass/SCSS 示例

   ```scss
   // 定义变量
   $primary: #1890ff;
   $spacing: 4px;
   
   // 混合（Mixin）
   @mixin flex-center {
     display: flex;
     justify-content: center;
     align-items: center;
   }
   
   // 嵌套写法
   .card {
     padding: $spacing * 4;
     border-radius: 8px;
     @include flex-center;
   
     &__title {
       font-size: 16px;
       color: $primary;
     }
   }
   ```

2. PostCSS + 插件

   - `postcss-preset-env`：使用未来 CSS 语法
   - `postcss-nested`：支持嵌套
   - `autoprefixer`：自动添加浏览器前缀

#### 1.8 工具辅助统一化

| 工具              | 作用                                      |
| ----------------- | ----------------------------------------- |
| **Stylelint**     | 检查 CSS 代码规范（如变量使用、命名规则） |
| **Prettier**      | 自动格式化 CSS/SCSS 代码                  |
| **CSS Modules**   | 局部作用域，避免类名冲突                  |
| **Design Tokens** | 将设计变量导出为 JSON，供多平台使用       |



### 二、表现层动画实现

---

#### 2.1 动画的核心原则

1. **流畅性**：60fps（每16.67ms一帧）为理想目标
2. **自然感**：使用缓动函数（Easing）模拟真实物理运动
3. **性能优先**：避免频繁重排（Reflow）和重绘（Repaint）
4. **可访问性**：提供 `prefers-reduced-motion` 降低动画强度

#### 2.2 CSS 动画实现方式（推荐优先使用）

1. CSS Transitions（过渡）

   适用于状态变化的简单动画（如悬停、点击）。

   ```css
   .button {
     background: #007bff;
     transition: background 0.3s ease, transform 0.2s ease;
   }
   
   .button:hover {
     background: #0056b3;
     transform: translateY(-2px);
   }
   ```

   属性：

   - `transition-property`: 过渡的属性（如 `background`, `transform`）。
   - `transition-duration`: 持续时间。
   - `transition-timing-function`: 缓动函数（`ease`, `linear`, `ease-in-out`, `cubic-bezier()`）。
   - `transition-delay`: 延迟。

   优点：性能好（GPU加速）、代码简洁。

   限制：只能定义“开始->结束”两个状态。

2. CSS Animations（关键帧动画）

   适用于**复杂**、**多步骤**的动画，**可循环播放**。

   ```css
   @keyframes fadeInUp {
     from {
       opacity: 0;
       transform: translateY(20px);
     }
     to {
       opacity: 1;
       transform: translateY(0);
     }
   }
   
   .animated-element {
     animation: fadeInUp 0.5s ease-out forwards;
   }
   ```

   常用属性：

   - `animation-name`: 关键帧名称
   - `animation-duration`: 持续时间
   - `animation-timing-function`: 缓动函数
   - `animation-delay`: 延迟
   - `animation-iteration-count`: 次数（`infinite` 无限循环）
   - `animation-direction`: 方向（`normal`, `reverse`, `alternate`）
   - `animation-fill-mode`: 动画前后状态（`forwards` 保持结束态）
   - `animation-play-state`: 控制播放/暂停（`running`, `paused`）

   优点：可定义多个中间状态，适合复杂动画。

   技巧：配合 transform 和 opacity 可触发 GPU 加速，性能最佳。

#### 2.3 高性能属性选择

优选使用能触发合成的属性，避免重排重绘：

| 推荐（GPU加速）                        | 避免（触发重排/重绘）   |
| -------------------------------------- | ----------------------- |
| `transform` (scale, rotate, translate) | `width`, `height`       |
| `opacity`                              | `left`, `top`（定位）   |
| `filter`（部分支持）                   | `margin`, `padding`     |
| `will-change`（提示浏览器）            | `display`, `visibility` |

```css
/* 推荐：使用 transform 代替 top/left */
.element {
  position: relative;
  /* ❌ 不推荐 */
  /* top: 10px; */
  
  /* ✅ 推荐 */
  transform: translateY(10px);
}
```



### 三、JavaScript 动画实现

---

当需要**精确控制**、**物理模拟**或**响应用户输入**时，使用JavaScript。

#### 3.1 requestAnimationFrame（rAF）

浏览器原生API，用于创建高性能动画循环。

```js
function animateElement(element, targetX) {
  let startX = 0;
  const duration = 500; // 500ms
  const startTime = performance.now();

  function step(currentTime) {
    const elapsed = currentTime - startTime;
    const progress = Math.min(elapsed / duration, 1);

    // 缓动函数：ease-out
    const easeProgress = 1 - Math.pow(1 - progress, 3);
    const currentX = easeProgress * targetX;

    element.style.transform = `translateX(${currentX}px)`;

    if (progress < 1) {
      requestAnimationFrame(step);
    }
  }

  requestAnimationFrame(step);
}
```

优点：与屏幕刷新率同步，性能最优。

适用：自定义动画逻辑、游戏、数据可视化。

#### 3.2 Web Animations API（现代标准）

浏览器原生 JavaScript 动画接口，结合了 CSS 和 JS 的优点。

```js
const element = document.querySelector('.box');

const animation = element.animate(
  [
    { transform: 'scale(1)', opacity: 1 },
    { transform: 'scale(1.2)', opacity: 0.8 },
    { transform: 'scale(1)', opacity: 1 }
  ],
  {
    duration: 500,
    easing: 'ease-out',
    iterations: 1,
    fill: 'forwards'
  }
);

// 可控制：animation.pause(), animation.play(), animation.reverse()
```

优点：无需 CSS、可动态生成、支持暂停/播放。

兼容性：现代浏览器支持良好（可加 polyfill）

#### 3.3 动画库（复杂场景）

| 库名                       | 特点                           | 适用场景                        |
| -------------------------- | ------------------------------ | ------------------------------- |
| **GSAP**                   | 功能强大、性能极佳、支持时间轴 | 复杂交互动画、营销页面、SVG动画 |
| **Anime.js**               | 轻量、灵活、链式调用           | 中小型项目动画                  |
| **Framer Motion**（React） | 声明式API、手势支持            | React项目中的微交互             |
| **Three.js**               | 3D动画与WebGL                  | 3D可视化、游戏                  |

```js
gsap.to(".card", {
  duration: 0.5,
  y: -10,
  opacity: 0.8,
  ease: "power2.out",
  paused: true,
  onStart: () => console.log("动画开始")
});
```



### 四、特殊动画类型实现

---

#### 4.1 滚动动画（Scroll Animation）

- Intersection Observer API：监听元素进入视口。
- ScrollTrigger（GSAP）：高级滚动触发动画。

```js
const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      entry.target.classList.add('animate-in');
      observer.unobserve(entry.target);
    }
  });
});

document.querySelectorAll('.scroll-item').forEach(el => {
  observer.observe(el);
});
```

#### 4.2 路径动画（SVG）

使用 `stroke-dasharray` 和 `stroke-dashoffset` 实现描边动画。

```css
.path {
  stroke-dasharray: 100;
  stroke-dashoffset: 100;
  animation: draw 2s ease-in-out forwards;
}

@keyframes draw {
  to {
    stroke-dashoffset: 0;
  }
}
```

#### 4.3 加载动画（Loading Spinner）

```css
.spinner {
  width: 40px;
  height: 40px;
  border: 4px solid #f3f3f3;
  border-top: 4px solid #3498db;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
```



### 五、动画性能优化

---

- 使用 `transform` 和 `opacity`。

- 避免动画 `layout` 属性（如 `width`, `height`, `margin`）。

- 使用 `will-change` 提示浏览器：

  ```css
  .animated {
    will-change: transform, opacity;
  }

- 减少动画元素数量，避免同时动画大量元素。

- 使用 `contain: layout/paint/strict` 隔离渲染。

- 降级处理：检测性能或用户偏好。

  ```css
  /* 尊重用户偏好 */
  @media (prefers-reduced-motion: reduce) {
    * {
      animation-duration: 0.01ms !important;
      transition-duration: 0.01ms !important;
    }
  }
  ```



### 六、选择合适的动画技术

---

| 需求               | 推荐方案                                        |
| ------------------ | ----------------------------------------------- |
| 悬停、状态变化     | `CSS Transitions`                               |
| 复杂多步动画       | `CSS Animations`                                |
| 精确控制、用户交互 | `requestAnimationFrame` 或 `Web Animations API` |
| 高级交互动画       | `GSAP` 或 `Anime.js`                            |
| React项目          | `Framer Motion`                                 |
| 3D/复杂可视化      | `Three.js`                                      |