### 一、线程与进程的区别

---

为了看起来像是“同时干多件事”，分时操作系统是把CPU的时间划分成长短基本相同的”时间片”，通过操作系统的管理，把这些时间片依次轮流地分配给各个用户的各个任务使用。

在多任务处理系统中，CPU需要处理所有程序的操作，当用户来回切换它们时，需要记录这些程序执行到哪里。在操作系统中，CPU切换到另一个进程需要保存当前进程的状态并恢复另一个进程的状态：当前运行任务转为就绪（或者挂起、删除）状态，另一个被选定的就绪任务成为当前任务。**上下文切换**就是这样一个过程，他**允许CPU记录并恢复各种正在运行程序的状态，使它能够完成切换操作**。 

>在上下文切换过程中，CPU会停止处理当前运行的程序，并保存当前程序运行的具体位置以便之后继续运行。在程序中，==上下文切换过程中的“页码”信息保存在进程控制块（PCB）中==。PCB还经常被称作“**切换帧**”（switchframe）。“页码”信息会一直保存到CPU的内存中，直到他们被再次使用。

对于操作系统来说，一个任务就是一个进程（Process），比如打开一个记事本就启动了一个记事本进程，打开两个记事本就启动了两个记事本进程。

而在多个进程之间切换的时候，需要进行上下文切换。但是上下文切换势必会耗费一些资源。于是人们考虑，能不能在一个进程中增加一些“子任务”，这样减少上下文切换的成本。比如我们使用Word的时候，它可以同时进行打字、拼写检查、字数统计等，这些子任务之间共用同一个进程资源，但是他们之间的切换不需要进行上下文切换。

==在一个进程内部，要同时干多件事，就需要同时运行多个“子任务”，我们把进程内的这些“子任务”称为线程（Thread）==。

随着时间的慢慢发展，人们进一步的切分了进程和线程之间的职责。**把进程当做资源分配的基本单元，把线程当做执行的基本单元，同一个进程的多个线程之间共享资源**

Java程序是运行在JVM上面的，**每一个JVM其实就是一个进程**。所有的资源分配都是基于JVM进程来的。而在这个JVM进程中，又可以创建出很多线程，多个线程之间共享JVM资源，并且多个线程可以并发执行。



### 二、线程的特点

---

在多线程操作系统中，通常是在一个进程中包括多个线程，每个线程都是作为利用CPU的基本单位，是花费最小开销的实体。线程具有以下属性。

#### 2.1 轻型实体

线程中的实体基本上不拥有系统资源，只是有一点必不可少的、能保证独立运行的资源。 **线程的实体包括程序、数据和TCB**。线程是动态概念，它的动态特性由线程控制块TCB（Thread Control Block）描述。TCB包括以下信息：

1. 线程状态。
2. 当线程不运行时，被保存的现场资源。
3. 一组执行堆栈。
4. 存放每个线程的局部变量主存区。
5. 访问同一个进程中的主存和其它资源。用于指示被执行指令序列的程序计数器、保留局部变量、少数状态参数和返回地址等的一组寄存器和堆栈。

#### 2.2 独立调度和分派的基本单位

在多线程操作系统中，线程是能独立运行的基本单位，因而也是独立调度和分派的基本单位。由于线程很“轻”，故线程的切换非常迅速且开销小（在同一进程中的）。

#### 2.3 可并发执行

在一个进程中的多个线程之间，可以并发执行，甚至允许在一个进程中所有线程都能并发执行；同样，不同进程中的线程也能并发执行，充分利用和发挥了处理机与外围设备并行工作的能力。

#### 2.4 共享进程资源

在同一进程中的各个线程，都可以共享该进程所拥有的资源，这首先表现在：**所有线程都具有相同的地址空间（进程的地址空间）**，这意味着，线程可以访问该地址空间的每一个虚地址；此外，还可以访问进程所拥有的已打开文件、定时器、信号量机构等。**由于同一个进程内的线程共享内存和文件，所以线程之间互相通信不必调用内核**。