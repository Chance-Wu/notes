zookeeper是一个==分布式协调框架==，主要用来==解决分布式应用中经常遇到的一些数据管理问题==，如：统一命名服务、状态同步服务、集群管理、分布式应用配置项的管理等。

#### 1. 设计目标

>1. 简单
>
>   允许分布式进程通过共享的分层命名空间相互协调，该命名空间的组织方式类似于标准文件系统。==命名空间由数据寄存器（在ZooKeeper中称为znode）组成==，它们类似于文件和目录，与设计用于存储典型文件系统不同，==ZooKeeper数据保留在内存中==，这意味着ZooKeeper可以实现高吞吐量和低延迟数。
>
>2. 可复制
>
>   zookeeper本身可以在称为集合的一组主机上进行复制。
>
>   <img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gmbr7zxhbyj30go055dg0.jpg" style="zoom:100%">
>
>   组成的Zookeeper服务的服务器必须彼此了解。==它们维护内存中的状态图像，以及持久存储中的事务日志和快照==。只要大多数服务器可用，ZooKeeper服务就可用。客户端连接到单个ZooKeeper服务器。客户端维护一个TCP连接，通过该连接发送请求，获取响应，获取监视事件并发送心跳。如果与服务器的TCP连接断开，则客户端将连接到其他服务器。
>
>3. 有序
>
>   ZooKeeper用一个反映所有ZooKeeper事务顺序的数字标记每个更新。 后续操作可以使用该命令来实现更高级别的抽象，例如synchronization primitives。
>
>4. 快速
>
>   ZooKeeper应用程序可在数千台计算机上运行，并且在读取比写入更常见的情况下，其性能最佳，比率约为10：1。

#### 2. 数据模型和分层命名空间

>ZooKeeper提供的==命名空间==与标准文件系统的命名空间非常相似。 名称是由斜杠 `/` 分隔的一系列路径元素。 ZooKeeper命名空间中的每个节点都由路径标识。
>
><img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gmbqvwohotj30ca071weg.jpg" style="zoom:100%">

#### 3. 节点和临时节点

>与标准文件系统不同，ZooKeeper命名空间中的每个节点都可以拥有与其相关的==data==以及==子节点==。就像拥有一个文件系统一样，该文件系统也允许文件成为目录。 （ZooKeeper旨在==存储协调数据==：*<u>状态信息，配置，位置信息等</u>*，因此存储在每个节点上的数据通常很小，在字节到千字节范围内。）
>
>使用术语`znode`来明确表示ZooKeeper数据节点。

>==znodes维护一个统计数据结构，其中包括用于数据更改，ACL更改和时间戳的版本号，以允许进行缓存验证和协调更新。==znode的数据每次更新时，版本号都会增加。例如，每当客户端检索数据时，它也接收数据的版本。
>
>读取将获取与znode关联的所有数据字节，而写入将替换所有数据。每个节点都有一个访问控制列表（ACL），用于限制谁可以执行操作。

>==临时节点==：只要创建znode的会话处于活动状态，这些znode就存在。会话结束时，将删除znode。

#### 4. 有条件的更新和监听

>客户端可以在znode上设置监听。
>
>- znode更改时，将触发并移除监听，之后，客户端会收到一个数据包，说明znode已更改。
>- 如果客户端和其中一个zookeeper服务器之间的连接断开，则客户端将收到本地通知。

>New in 3.6.0：客户端也可以在一个znode上设置永久的递归监听器，这些监视在被触发时不会被删除，并且会递归地触发注册的znode以及任何子znode上的变化。

#### 5. 特点

>基于zookeeper的目标是构建更复杂的服务（列入同步）的基础，它具备了以下特点：
>
>- 顺序一致性(Sequential Consistency)：来自客户端的更新将按照其发送顺序进行应用。
>- 原子性(Atomicity)：更新要么全部成功，要么全部失败。
>- 单一系统镜像(Single System Image)：客户端无论连到哪个zookeeper服务器，看到的服务端视图都是一致的。
>- 可靠性(Reliability)：应用更新后，此更新将一直存在，直到客户端覆盖更新。
>- 及时性(Timeliness)：确保系统的客户视图在特定时间范围内是最新的。



